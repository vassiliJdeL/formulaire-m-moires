<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Soumission de mémoire / Thesis submission</title>
</head>
<body>
  <h2>Soumission de mémoire / Thesis submission</h2>

  <form action="https://hook.eu2.make.com/404rtrr13j5vbygd0zi1ck9wkv4j0hlm" method="post">
    <label for="prenom">Prénom / First name:</label><br />
    <input type="text" id="prenom" name="prenom" required /><br /><br />

    <label for="nom">Nom / Last name:</label><br />
    <input type="text" id="nom" name="nom" required /><br /><br />

    <label for="titre">Titre du mémoire / Thesis title:</label><br />
    <input type="text" id="titre" name="titre" required /><br /><br />

    <label for="email">Adresse email / Email address:</label><br />
    <input type="email" id="email" name="email" required /><br /><br />

    <label for="langue">Langue du mémoire / Thesis language:</label><br />
    <select id="langue" name="langue" required>
      <option value="">-- Choisissez / Select --</option>
      <option value="français">Français / French</option>
      <option value="anglais">Anglais / English</option>
    </select><br /><br />

    <label for="file">Téléverser le fichier / Upload your file (.docx only):</label><br />
    <input type="hidden" role="uploadcare-uploader" 
           name="file" 
           data-public-key="21d7228fa1f01ac80183" 
           data-clearable 
           data-file-types=".docx" /><br /><br />

    <label>
      <input type="checkbox" name="rgpd" required />
      J'accepte le traitement automatisé de mes données dans le cadre de l'évaluation de mon mémoire. /
      I agree to the automated processing of my data for the purpose of evaluating my thesis.
    </label><br /><br />

    <!-- ✅ Champ caché TOKEN ajouté ici -->
    <input type="hidden" name="token" value="2_TOUGH_eval_5_on" />

    <button type="submit">Soumettre / Submit</button>
  </form>

  <div id="confirmation" style="display:none; margin-top:20px;">
    <h2>🇫🇷 Mémoire reçu avec succès</h2>
    <p>Merci, ton mémoire a bien été soumis.<br />
    ⏳ <strong>L’évaluation est en cours de traitement.</strong><br />
    Tu la recevras par email dans les prochaines minutes, à l’adresse que tu as indiquée.<br />
    📩 <strong>Pense à vérifier aussi tes courriers indésirables</strong> (spams), surtout si tu utilises une adresse universitaire, Hotmail ou Outlook.</p>
    <hr />
    <h2>🇬🇧 Thesis successfully submitted</h2>
    <p>Thank you, your thesis has been successfully submitted.<br />
    ⏳ <strong>Your evaluation is being processed.</strong><br />
    You will receive it by email within the next few minutes, at the address you provided.<br />
    📩 <strong>Don’t forget to check your spam folder</strong>, especially if you are using a university, Hotmail or Outlook email.</p>
  </div>

  <script>
    UPLOADCARE_PUBLIC_KEY = "21d7228fa1f01ac80183";
  </script>
  <script src="https://ucarecdn.com/libs/widget/3.x/uploadcare.full.min.js"></script>

  <script>
    document.querySelector('form').addEventListener('submit', function (e) {
      e.preventDefault(); // Empêche le rechargement
      const form = e.target;
      const formData = new FormData(form);

      fetch(form.action, {
        method: 'POST',
        body: formData
      })
      .then(response => {
        if (response.ok) {
          form.style.display = 'none';
          document.getElementById('confirmation').style.display = 'block';
        } else {
          alert("Erreur lors de la soumission. Veuillez réessayer.");
        }
      })
      .catch(() => {
        alert("Erreur de connexion. Veuillez réessayer.");
      });
    });
  </script>
</body>
</html>
